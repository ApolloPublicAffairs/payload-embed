<html>
<title>Payload Front-End Processing</title>
<head>
<script src="2015REPORDSIMPLIFIED.geojson" type="text/javascript"></script>
<script src="payload.min.js" type="text/javascript"></script>
</head>
<body>
    <div>
        <h1>Instructions - Kanata Lookup?</h1>
        <p>Geojson is stupid and accepts longitude before latitude. If you're pulling from Google Maps or off a map, reverse your coordinate entries because REASONS.</p>
        <label for="lat">Longitude</label>
        <input type="text" value="45.30990078271359" name="Longitude" class="required" id="inputlong" required>
        <label for="lat">Latitude</label>
        <input type="text" value="-75.90568081058741" name="Latitude" class="required" id="inputlat" required>
        <input type="submit" value="test" name="testfunction" id="submission" class="button" onclick="TestKanata()">
    </div>
    <div>
        <h1>Results
        </h1>
        <h3 id="resultreport">None</h3>
    </div>
    <div>
</body>


<script>

function TestKanata() {
// grab the GeoJSON file via network request and pare into object
        fetch('https://apollopublicaffairs.github.io/payload-embed/2015REPORDSIMPLIFIED.geojson').then(function (response){
                return response.json();;
        }).then(function (constitdata) {
    //declare all the variables
        var poly = turf.polygon(constitdata.features[90].geometry.coordinates);
        var long = new String (document.getElementById("inputlong").value);
        var lat = new String (document.getElementById("inputlat").value);
        var pt = turf.point([lat,long]);

        // log data stream for error checking
        console.log("Poly");
        console.log(poly);
        console.log("Long");
        console.log(long);
        console.log("lat");
        console.log(lat);
        console.log("pt");
        console.log(pt);

        // run the evaluation of of whether the point is in Kanata.
        var eval = turf.booleanPointInPolygon(pt, poly)
        // output result of test
        console.log(eval)
        document.getElementById("resultreport").innerHTML = eval
       
}).catch(function (error) {
    console.error('Something fucked up')
})

}

</script>

</html>